var Node        = require('famous/core/Node');
var DOMElement  = require('famous/dom-renderables/DOMElement');
var Button      = require('button');
var FooterButton = require('FooterButton');
var UserModel = require('model/UserModel');

function Footer()
{
	Node.call(this);
	this.footerButton = [];
	this.setSizeMode(0,1)
		.setAbsoluteSize(null,60)
		.el = new DOMElement(this,{
			classes:['footer'],
			properties:{'box-shadow':'0 -2px 3px rgba(0,0,0,.1','z-index':'2'}
		});

	initContent(this);

	
}

Footer.prototype = Object.create(Node.prototype);
Footer.prototype.constructor = Footer;

function initContent(node)
{

	var imagePath = "./images/home/";

	var homeButton = node.addChild(new FooterButton(null,imagePath+"home_select.png",imagePath+"home_deselect.png"));
		homeButton.setSizeMode(0,0)
				  .setProportionalSize(0.19)
				  .setAlign(0,0)
				 .pageIndex = 1;homeButton.imageView.setAbsoluteSize(23,37);

	var discorverButton = node.addChild(new FooterButton(null,imagePath+"discorver_select.png",imagePath+"discorver_deselect.png"));
		discorverButton.setSizeMode(0,0)
					   .setProportionalSize(0.19)
					   .setAlign(0.19,0)
					   .pageIndex = 2;

	var releaseButton = node.addChild(new Button(" "));
		releaseButton.setSizeMode(0,1)
					 .setProportionalSize(0.24)
					 .setAbsoluteSize(null,66)
					 .setPosition(0,-18)
					 .setAlign(0.38,0).clickEvent = function(){
					 	if(UserModel.findOne().token){
					 		var router = require('Router');
					 		router.to('release');
					 	}else{
					 		alert('请先登录',function(){
					 			require('Router').to('LoginPage');
					 		},'U妈提示');
					 	}
					 	
					 }

	var msgButton = node.addChild(new FooterButton(null,imagePath+"msg_select.png",imagePath+"msg_deselect.png"));
		msgButton.setSizeMode(0,0)
				 .setProportionalSize(0.19)
				 .setAlign(0.62,0)
				 .pageIndex = 3;msgButton.imageView.setAbsoluteSize(22,37)

	var accountButton = node.addChild(new FooterButton(null,imagePath+"account_select.png",imagePath+"account_deselect.png"));
		accountButton.setSizeMode(0,0)
					 .setProportionalSize(0.19)
					 .setAlign(0.81)
					 .pageIndex = 4;accountButton.imageView.setAbsoluteSize(19,37)

	node.footerButton = [homeButton,discorverButton,msgButton,accountButton];

}

Footer.prototype.onReceive = function(e,p)
{
	// if(e==='click'){
	// 	if (p.node.pageIndex)
	// 	{
	// 		this.footerButton.forEach(function(node)
	// 		{
	// 			node.deSelect();
	// 		});
	// 		p.node.didSelect();
	// 	}
	// }
	
};


module.exports = Footer;